<!DOCTYPE html>
<html lang="zh-Hant-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>百香果B2C｜會員</title>
    <link rel="stylesheet" href="./styles/myall.css">
    <link rel="stylesheet" href="./styles/style.css">
    <link rel="stylesheet" href="./styles/bootstrap.min.css">
    <link rel="shortcut icon" href="./icon/title.ico">
    <style>
        header {
            top: 0;
            z-index: 10;
        }
        .navtitle{
            background: linear-gradient(135deg,var(--mycolor8),var(--mycolor1));
        }
    </style>
</head>

<body>
    <!-- 回上層按鈕 -->
    <!-- <div id="backtop" class="toTop-arrow">
        <img src="./images/LOGO.png">
    </div> -->
    <!-- 選單列 -->
    <header>
        <nav class="navbar navbar-expand-lg navtitle">
            <div class="container-fluid logo">
                <a class="navbar-brand" href="./index.html">
                    <img src="./images/LOGOone.png" alt="百香果B2C">
                    <p class="logotext">百香果B2C</p>
                </a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse"
                    data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false"
                    aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                    <div class="navbar-nav">
                        <a class="nav-link text-danger" aria-current="page" href="./index.html">百香果B2C</a>
                        <a class="nav-link" href="./about.html" target="_self">關於我們</a>
                        <a class="nav-link" href="./product.html" target="_self">商品訂購</a>
                        <a class="nav-link" href="./contactus.html" target="_self">聯絡我們</a>
                        <a class="nav-link" href="#" type="button" data-bs-toggle="modal"
                            data-bs-target="#suflist">訂單查詢</a>
                    </div>
                </div>
            </div>
        </nav>
    </header>
    <!-- 登入彈出介面 -->
    <div class="modal fade" id="suflist">
        <!--讓上面的超連接來連結-->
        <div class="modal-dialog">
            <!--彈出框框-->
            <div class="modal-content">
                <!-- header -->
                <div class="modal-header">
                    <h3>訂單查詢</h3>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <!-- body -->
                <div class="modal-body">
                    <div>
                        <div class="mb-3 username">
                            <label for="" class="form-label">訂單編號</label>
                            <input id="listname" type="text" class="form-control " placeholder="請輸入訂單編號">
                        </div>
                        <div class="mb-3 usermimi">
                            <label for="tel" class="form-label">電話</label>
                            <input id="tel" type="text" class="form-control" placeholder="請輸入電話號碼">
                        </div>
                        <div class="mb-3">
                            <label for="" class="form-label">購買日期</label>
                            <input type="date" name="" id="buyday" class="form-control">
                        </div>
                        <div class="form-check form-switch">
                            <input type="checkbox" class="form-check-input" role="switch" name="sw1" id="sw1">
                            <label class="form-check-label" for="sw1">未確認資料</label>
                        </div>
                        <button id="OK_btn" class="btn btn-info" style="width: 100%;">確認</button>
                    </div>
                </div>
                <!-- footer -->
                <div class="modal-footer">
                    <a href="#" type="button">聯絡客服</a>
                </div>
            </div>
        </div>
    </div>

    <main class="main6">
        <div class="container">
            <div class="row">
                <div class="welcome mt-5" id="visitor">商家</div>
                <table class="table table-active table-bordered mt-5">
                    <thead class="table-dark">
                        <tr>
                            <th>訂單編號</th>
                            <th>訂購日期</th>
                            <th>電話</th>
                            <th>訂單內容</th>
                            <th>總金額</th>
                        </tr>
                    </thead>
                    <tbody id="show">
                        <tr >
                            <td id="fulist" data-th="訂單編號">XXXX</td>
                            <td id="fudate" data-th="訂購日期">XXXX</td>
                            <td id="futel" data-th="電話">XXXX</td>                            
                            <td id="fruit" data-th="訂單內容">XXXX</td>                            
                            <td id="monmon" data-th="總金額">XXXX</td>
                        </tr>
                    </tbody>
                </table>
                <div class="btns my-3 d-flex justify-content-end">
                    <button class="btn btn-success me-2" id="btn_change1" data-bs-toggle="modal" data-bs-target="#newtel">修改電話</button>
                    <button class="btn btn-info me-2" id="btn_change2" data-bs-toggle="modal" data-bs-target="#newcont">修改數量</button>
                    <button class="btn btn-danger" id="btn-reset" data-bs-toggle="modal" data-bs-target="#alldelete">刪除</button>
                </div>
            </div>
        </div>

        <!-- 修改電話畫面 -->
        <div class="modal fade" id="newtel">
            <!--讓上面的超連接來連結-->
            <div class="modal-dialog">
                <!--彈出框框-->
                <div class="modal-content">
                    <!-- header -->
                    <div class="modal-header d-flex justify-content-center">
                        <h3 class="text-center">修改電話</h3>
                    </div>
                    <!-- body -->
                    <div class="modal-body">
                        <div>
                            <div class="mb-3">
                                <label for="" class="form-label">訂單編號</label>
                                <input id="newlistname1" type="text" class="form-control " placeholder="請輸入訂單編號">
                            </div>
                            <div class="mb-3">
                                <label for="tel" class="form-label">電話</label>
                                <input id="newtel" type="text" class="form-control" placeholder="請輸入電話號碼">
                            </div>
                            <div class="telbtn mt-2 d-flex justify-content-between">
                                <button id="telOK_btn" class="btn btn-success w-25" >確認</button>
                                <button  class="btn btn-danger w-25" data-bs-dismiss="modal">取消</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 修改數量畫面 -->
        <div class="modal fade" id="newcont">
            <!--讓上面的超連接來連結-->
            <div class="modal-dialog">
                <!--彈出框框-->
                <div class="modal-content">
                    <!-- header -->
                    <div class="modal-header d-flex justify-content-center">
                        <h3 class="text-center">修改數量</h3>
                    </div>
                    <!-- body -->
                    <div class="modal-body">
                        <div>
                            <div class="mb-3">
                                <label for="" class="form-label">訂單編號</label>
                                <input id="newlistname2" type="text" class="form-control " placeholder="請輸入訂單編號">
                            </div>
                            <div class="mb-3">
                                <label for="newcont" class="form-label">修改數量</label>
                                <input id="newcont" type="text" class="form-control" placeholder="請輸入修改數量">
                            </div>
                            <div class="telbtn mt-2 d-flex justify-content-between">
                                <button id="contOK_btn" class="btn btn-success w-25" >確認</button>
                                <button class="btn btn-danger w-25" data-bs-dismiss="modal">取消</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
         <!-- 刪除畫面 -->
         <div class="modal fade" id="alldelete">
            <!--讓上面的超連接來連結-->
            <div class="modal-dialog">
                <!--彈出框框-->
                <div class="modal-content">
                    <!-- header -->
                    <div class="modal-header d-flex justify-content-center">
                        <h3 class="text-center">刪除訂單</h3>
                    </div>
                    <!-- body -->
                    <div class="modal-body">
                        <div>
                            <div class="mb-3">
                                <label for="" class="form-label">訂單編號</label>
                                <input id="newlistname3" type="text" class="form-control " placeholder="請輸入訂單編號">
                            </div>
                            <div class="telbtn mt-2 d-flex justify-content-between">
                                <button id="alldeleteOK_btn" class="btn btn-success w-25" >確認</button>
                                <button class="btn btn-danger w-25" data-bs-dismiss="modal">取消</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
    <!-- 頁尾 -->
    <footer class="footer">
        <div>
            <p>Copyright © 2023 GaWei. All rights reserved.</p>
        </div>
    </footer>

    <script src="./js/Jquery.js"></script>
    <script src="./js/bootstrap.bundle.min.js"></script>
    <script src="./js/list.js"></script>



    <script>
        $(function(){
            //呈現表單
            $.ajax({
                type:"GET",
                url:"./20231211-Readdb.php",
                dataType:"json",
                success :showdata,
                error:function(){
                    alert("錯誤");
                }
            });


            //刪除訂單

            $("#alldeleteOK_btn").bind("click",function(){
                // console.log($("#newlistname3").val());
                let dev = $("#newlistname3").val();
                
                if(dellist.indexOf(dev) == -1){
                    alert("無此訂單");
                }else{
                    if(confirm("確定要刪除"+dev)){
                    $.ajax({
                        type:"POST",
                        url:"./20231211-Deletedb.php",
                        data:{flist:dev},
                        success:showdelete,
                        error:function(){
                            alert("刪除失敗!");
                        }
                    });
                }
                }








            });
        });


        let dellist=[];
        function showdata(data){
            // console.log(data);
            $("#show").empty();
            data.forEach(function(item){
                dellist.push(item.flist);
                // console.log(item.flist);
                let strhtml = '<tr><td id="fulist" data-th="訂單編號">'+item.flist+'</td><td id="fudate" data-th="訂購日期">'+item.fdate+'</td><td id="futel" data-th="電話">'+item.ftel+'</td><<td id="fruit" data-th="訂單內容">'+item.fcont+'箱</td><td id="monmon" data-th="總金額">'+item.fmon+'</td></tr>';
                $("#show").append(strhtml);
            });
        }

        //刪除
        function showdelete(){
            console.log("OK");
            alert("刪除成功");
            location.href="./login.html";
        }
    </script>
</body>

</html>